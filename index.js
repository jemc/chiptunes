(()=>{"use strict";var t={480:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.AutoMap=void 0;class AutoMap extends Map{constructor(t){super(),this.vClass=t}getOrCreate(t){const e=this.get(t);if(e)return e;const s=new this.vClass;return this.set(t,s),s}}e.AutoMap=AutoMap},376:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.BitMask=void 0;const i=s(872);e.BitMask=class BitMask{constructor(t=16){const e=Math.ceil(t/16);this.data=new Uint16Array(e)}clear(){this.data.fill(0)}set(t,e){const s=t>>4,o=1<<t%16;if(this.data.length<=s){const t=(0,i.roundUpToPowerOfTwo)(s+1),e=new Uint16Array(t).fill(0);e.set(this.data),this.data=e}return e?this.data[s]|=o:this.data[s]&=~o,!0}isSuperSetOf(t){for(var e,s,i=0;i<this.data.length;i++){const o=null!==(e=this.data[i])&&void 0!==e?e:0,r=null!==(s=t.data[i])&&void 0!==s?s:0;if((r&o)!==r)return!1}return!0}}},764:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MutableBox2=e.Box2=void 0;const i=s(724);class BaseBox2{constructor(t,e){this.center=t,this.radii=e}isEqualTo(t){return this.center.isEqualTo(t.center)&&this.radii.isEqualTo(t.radii)}doesContain(t){return!(Math.abs(t.x-this.center.x)>this.radii.x)&&!(Math.abs(t.y-this.center.y)>this.radii.y)}get x(){return this.center.x}get y(){return this.center.y}get x0(){return this.center.x-this.radii.x}get y0(){return this.center.y-this.radii.y}get x1(){return this.center.x+this.radii.x}get y1(){return this.center.y+this.radii.y}get width(){return this.radii.x+this.radii.x}get height(){return this.radii.y+this.radii.y}}class Box2 extends BaseBox2{constructor(t=new i.Vector2,e=new i.Vector2){super(t,e),this.center=t,this.radii=e}static fromLeftTopWidthHeight(t,e,s,o){const r=new i.Vector2(s/2,o/2);return new Box2(new i.Vector2(t+r.x,e+r.y),r)}__preventTypeConfusion(){return"immutable"}}e.Box2=Box2;e.MutableBox2=class MutableBox2 extends BaseBox2{constructor(t=new i.MutableVector2,e=new i.MutableVector2){super(t,e),this.center=t,this.radii=e}__preventTypeConfusion(){return"mutable"}copyFrom(t){return this.center.copyFrom(t.center),this.radii.copyFrom(t.radii),this}}},816:(t,e,s)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.ButtonSourceSystem=e.ButtonSourceConfig=e.ButtonSource=e.ButtonState=e.Button=void 0;const o=s(100);var r;!function(t){t[t.Start=0]="Start",t[t.Select=1]="Select",t[t.Up=2]="Up",t[t.Down=3]="Down",t[t.Left=4]="Left",t[t.Right=5]="Right",t[t.A=6]="A",t[t.B=7]="B",t[t.X=8]="X",t[t.Y=9]="Y"}(r||(e.Button=r={}));e.ButtonState=class ButtonState{constructor(t){this.clock=t,this.pressedAt=new Array}capture(t){void 0===this.pressedAt[t]&&(this.pressedAt[t]=this.clock.frame+1)}release(t){delete this.pressedAt[t]}isPressed(t){return void 0!==this.pressedAt[t]}isPressedJustNow(t){return this.pressedAt[t]===this.clock.frame}};class ButtonSource{constructor(t,e){this.state=t,this.config=e}captureKeyboardEvent(t){const e=this.config.keyboard[t.code];return!!e&&void 0!==e.find((e=>{if(!e.ignoreModifiers){if(t.altKey!=!!e.alt)return!1;if(t.ctrlKey!=!!e.ctrl)return!1;if(t.shiftKey!=!!e.shift)return!1}return this.state.capture(e.button),!0}))}releaseKeyboardEvent(t){const e=this.config.keyboard[t.code];if(!e)return;let s=!1;for(const t of e)this.state.isPressed(t.button)&&(this.state.release(t.button),s=!0);return s}}e.ButtonSource=ButtonSource,i=ButtonSource,ButtonSource.componentId=(0,o.registerComponent)(i),e.ButtonSourceConfig={Default:{keyboard:{Enter:[{button:r.Start}],RightShift:[{button:r.Select}],ArrowUp:[{button:r.Up}],ArrowDown:[{button:r.Down}],ArrowLeft:[{button:r.Left}],ArrowRight:[{button:r.Right}],KeyW:[{button:r.Up}],KeyA:[{button:r.Left}],KeyS:[{button:r.Down}],KeyD:[{button:r.Right}],KeyZ:[{button:r.A}],KeyX:[{button:r.B}],KeyC:[{button:r.X}],KeyV:[{button:r.Y}],ControlRight:[{button:r.A}],AltRight:[{button:r.B}]}}},e.ButtonSourceSystem=function(t,e){const s=new Map;return e.addEventListener("keydown",(t=>{const e=t;for(const i of s.values())i.captureKeyboardEvent(e)&&t.preventDefault()})),e.addEventListener("keyup",(t=>{const e=t;for(const i of s.values())i.releaseKeyboardEvent(e)&&t.preventDefault()})),t.systemFor([ButtonSource],{runEachSet(t,e){s.set(t,e)},runEachRemoved(t){s.delete(t)}})}},185:(t,e,s)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.ChildOf=void 0;const o=s(100);class ChildOf{constructor(t){this.parent=t}}e.ChildOf=ChildOf,i=ChildOf,ChildOf.componentId=(0,o.registerComponent)(i)},676:(t,e,s)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.Clock=void 0;const o=null===(i=s.g.window)||void 0===i?void 0:i.requestAnimationFrame;e.Clock=class Clock{constructor(t=(()=>{}),e=(null!=o?o:void 0)){this.runFn=t,this.requestNextFrame=e,this.frame=0,this.timestamp=0,this.currentFramesPerSecond=0,this.alreadyStarted=!1,this.tickAndKeepRunningFn=this.tickAndKeepRunning.bind(this)}startRunning(){this.alreadyStarted||(this.requestNextFrame&&this.requestNextFrame(this.tickAndKeepRunningFn),this.alreadyStarted=!0)}tickAndKeepRunning(t){this.tick(t),o(this.tickAndKeepRunningFn)}tick(t){const e=1e3/(t-this.timestamp);if(this.slowMotionFactor&&this.slowMotionFactor>60/e)return;const s=this;s.frame++,s.timestamp=t,s.currentFramesPerSecond=e,this.runFn()}}},100:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.newEntityPoolWithStaticComponentsReserved=e.getComponentClassById=e.registerComponent=void 0;const i=s(216),o=new i.EntityPool,r=[];e.registerComponent=function(t){if(Object.isFrozen(o))throw new Error("A component can only be registered statically before any world is created. After that they can only be registered dynamically with an individual world (which is not yet supported).");const e=o.alloc();return r[e]=t,e},e.getComponentClassById=function(t){return r[t]},e.newEntityPoolWithStaticComponentsReserved=function(){return Object.freeze(o),new i.EntityPool(o)}},704:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0})},216:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.EntityPool=void 0;e.EntityPool=class EntityPool{constructor(t){this.bitPool=new Uint8Array(1024).fill(255),this.firstNonZeroByteIndex=0,t&&(this.bitPool=new Uint8Array(t.bitPool.length).fill(255),this.bitPool.set(t.bitPool),this.firstNonZeroByteIndex=t.firstNonZeroByteIndex)}get capacity(){return 8*this.bitPool.length}alloc(){const t=this.firstNonZeroByteIndex;var e=this.bitPool[t];const s=Math.log2(e&-e);if(e&=~(1<<s),this.bitPool[t]=e,0==e&&(this.firstNonZeroByteIndex++,this.firstNonZeroByteIndex>=this.bitPool.length)){const t=new Uint8Array(2*this.bitPool.length).fill(255);t.set(this.bitPool),this.bitPool=t}return(t<<3)+s}free(t){const e=t>>3,s=7&t;this.bitPool[e]|=1<<s,e<this.firstNonZeroByteIndex&&(this.firstNonZeroByteIndex=e)}}},248:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LoadAsset=void 0;e.LoadAsset=class LoadAsset{constructor(t){this.url=t,setTimeout((()=>this.load()))}get result(){return this._result}get isFinished(){return void 0!==this._result}finished(t){this.isFinished||(this._result=t)}}},351:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LoadBlobAsset=void 0;const i=s(248);class LoadBlobAsset extends i.LoadAsset{load(){const t=this,e=new XMLHttpRequest;e.responseType="blob",e.onload=()=>t.finished(e.response),e.open("GET",t.url+"?cb="+Date.now(),!0),e.send()}}e.LoadBlobAsset=LoadBlobAsset},528:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.LoadImageAsset=void 0;const i=s(248);class LoadImageAsset extends i.LoadAsset{load(){const t=this,e=new Image;e.onload=()=>t.finished(e),e.crossOrigin="anonymous",e.src=t.url+"?cb="+Date.now()}}e.LoadImageAsset=LoadImageAsset},872:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.isPowerOfTwo=e.roundUpToPowerOfTwo=e.toDegrees=e.toRadians=void 0;const s=Math.PI/180;e.toRadians=function(t){return t*s};const i=180/Math.PI;e.toDegrees=function(t){return t*i},e.roundUpToPowerOfTwo=function(t){const e=t<0?-1:1;return t*=e,t-=1,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t|=t>>32,(t+=1)*e},e.isPowerOfTwo=function(t){return 0==(t&t-1)}},116:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Matrix3=void 0;const i=s(724);e.Matrix3=class Matrix3{static create(){return this.setToIdentity(new Float32Array(9))}static setToIdentity(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}static setTransformRows(t,e,s,i,o){t[0]=i*s.x,t[1]=-o*s.y,t[2]=Math.floor(e.x),t[3]=o*s.x,t[4]=i*s.y,t[5]=Math.floor(e.y)}static multiply(t,e,s){{const i=t[0],o=t[1],r=t[2],n=t[3],a=t[4],c=t[5],u=t[6],l=t[7],d=t[8],h=e[0],f=e[1],m=e[2],v=e[3],p=e[4],y=e[5],b=e[6],g=e[7],w=e[8];s[0]=h*i+f*n+m*u,s[1]=h*o+f*a+m*l,s[2]=h*r+f*c+m*d,s[3]=v*i+p*n+y*u,s[4]=v*o+p*a+y*l,s[5]=v*r+p*c+y*d,s[6]=b*i+g*n+w*u,s[7]=b*o+g*a+w*l,s[8]=b*r+g*c+w*d}return s}static applyToVector2(t,e){return new i.Vector2(e.x*t[0]+e.y*t[1]+t[2],e.x*t[3]+e.y*t[4]+t[5])}}},260:(t,e,s)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.StatusSystem=e.Status=void 0;const o=s(100);class Status{constructor(t,e){var s,i;this.clock=t,this.configs={},this.map={},this.configs=e;for(const[t,i]of Object.entries(e))if(i.blocks)for(const e of i.blocks){const i=this.configs[e];i&&(i.blockedBy=null!==(s=i.blockedBy)&&void 0!==s?s:[],i.blockedBy.push(t))}for(const[t,s]of Object.entries(e))if(s.sustains)for(const e of s.sustains){const s=this.configs[e];s&&(s.sustainedBy=null!==(i=s.sustainedBy)&&void 0!==i?i:[],s.sustainedBy.push(t))}for(const[t,s]of Object.entries(e))s.setAtStart&&this.set(t)}get list(){return Object.keys(this.map)}is(t){return void 0!==this.map[t]}isStarting(t){return this.map[t]===this.clock.frame}stop(t){if(void 0===this.map[t])return;const e=this.configs[t];if(null==e?void 0:e.sustainedBy)for(const t of e.sustainedBy)if(this.is(t))return;delete this.map[t],(null==e?void 0:e.then)&&e.then.forEach((t=>this.set(t)))}set(t,e=!0){if(!e)return void this.stop(t);if(void 0!==this.map[t])return;const s=this.configs[t];if(null==s?void 0:s.blockedBy)for(const t of s.blockedBy)if(this.is(t))return;this.map[t]=this.clock.frame,(null==s?void 0:s.sets)&&s.sets.forEach((t=>this.set(t))),(null==s?void 0:s.stops)&&s.stops.forEach((t=>this.stop(t)))}setMany(t){for(const[e,s]of Object.entries(t))this.set(e,s)}each(t){for(const[e,s]of Object.entries(this.map)){const i=this.configs[e];i&&t(e,i,s)}}noticeTime(){for(const[t,e]of Object.entries(this.map)){const s=this.configs[t];(null==s?void 0:s.maxFrames)&&(null==s?void 0:s.maxFrames)<this.clock.frame-e&&this.stop(t)}}}e.Status=Status,i=Status,Status.componentId=(0,o.registerComponent)(i);e.StatusSystem=t=>t.systemFor([Status],{runEach(t,e){e.noticeTime()}})},605:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.System=void 0;const i=s(376);e.System=class System{constructor(t){this.componentTypes=t,this._requiredBits=new i.BitMask,this._entities=new Map}setEntityComponents(t,e){const s=this._entities.size;this._entities.set(t,e),s!==this._entities.size?this.runEachAdded(t,...e):this.runEachModified(t,...e),this.runEachSet(t,...e)}removeEntityIfPresent(t){const e=this._entities.size;this._entities.delete(t),e!==this._entities.size&&this.runEachRemoved(t)}run(t){for(const[e,s]of t.entries())this.runEach(e,...s)}runEach(t,...e){}runEachAdded(t,...e){}runEachModified(t,...e){}runEachSet(t,...e){}runEachRemoved(t){}}},748:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Uint32Array2D=void 0;const i=s(724);class Uint32Array2D{get width(){return this.size.x}get height(){return this.size.y}constructor(t,e=new i.Vector2(0,0)){this.size=t,this.offset=e,this.buffer=new ArrayBuffer(this.width*this.height*4),this.rawBytes=new Uint8Array(this.buffer),this.rawUint32s=new Uint32Array(this.buffer)}static fromArrayLiterals(t,e=new i.Vector2(0,0)){var s,o;const r=new i.Vector2(null!==(o=null===(s=t[0])||void 0===s?void 0:s.length)&&void 0!==o?o:0,t.length),n=new Uint32Array2D(r,e);return n.rawUint32s.set(t.flat()),n}get(t,e){var s;return t-=this.offset.x,e-=this.offset.y,t<0||e<0||t>=this.width||e>=this.height?0:null!==(s=this.rawUint32s[t+e*this.width])&&void 0!==s?s:0}set(t,e,s){if(t-=this.offset.x,e-=this.offset.y,t<0||e<0||t>=this.width||e>=this.height)throw new Error(`set element out of bounds: (${t}, ${e}) within ${this.size.x} x ${this.size.y} size with offset (${this.offset.x}, ${this.offset.y})`);this.rawUint32s[t+e*this.width]=s}forEach(t){for(var e=0;e<this.rawUint32s.length;e++){const s=e%this.width,i=Math.floor(e/this.width);t(this.rawUint32s[e],s+this.offset.x,i+this.offset.y)}}cloneWithoutOffset(){const t=new Uint32Array2D(this.size.plus(this.offset));return t.rawUint32s.fill(0),this.forEach(((e,s,i)=>{t.rawUint32s[s+i*t.width]=e})),t}}e.Uint32Array2D=Uint32Array2D},724:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MutableVector2=e.Vector2=void 0;const i=s(872);class BaseVector2{constructor(t=0,e=0){this.x=t,this.y=e}isEqualTo(t){return this.x===t.x&&this.y===t.y}clone(){return new Vector2(this.x,this.y)}cloneMutable(){return new MutableVector2(this.x,this.y)}magnitude(){return Math.sqrt(this.magnitudeSquared())}magnitudeSquared(){return this.x*this.x+this.y*this.y}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}plus(t){return new Vector2(this.x+t.x,this.y+t.y)}minus(t){return new Vector2(this.x-t.x,this.y-t.y)}scale(t){return new Vector2(this.x*t,this.y*t)}}class Vector2 extends BaseVector2{__preventTypeConfusion(){return"immutable"}}e.Vector2=Vector2;class MutableVector2 extends BaseVector2{constructor(t=0,e=0){super(t,e),this.x=t,this.y=e}__preventTypeConfusion(){return"mutable"}setTo(t,e){return this.x=t,this.y=e,this}copyFrom(t){return this.x=t.x,this.y=t.y,this}setUnitRotationRadians(t){return this.x=Math.cos(t),this.y=Math.sin(t),this}setUnitRotationDegrees(t){return this.setUnitRotationRadians((0,i.toRadians)(t)),this}toFloor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}toRoundedCapturingResiduals(t){const{x:e,y:s}=this;return this.x=Math.round(e),this.y=Math.round(s),t.x=e-this.x,t.y=s-this.y,this}plusEquals(t){return this.x+=t.x,this.y+=t.y,this}plusScalarEquals(t){return this.x+=t,this.y+=t,this}minusEquals(t){return this.x-=t.x,this.y-=t.y,this}minusScalarEquals(t){return this.x-=t,this.y-=t,this}multiplyEquals(t){return this.x*=t.x,this.y*=t.y,this}scaleEquals(t){return this.x*=t,this.y*=t,this}inverseScaleEquals(t){return this.x/=t,this.y/=t,this}plusScaledEquals(t,e){return this.x+=t.x*e,this.y+=t.y*e,this}}e.MutableVector2=MutableVector2},776:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.World=void 0;const i=s(100),o=s(605),r=s(676),n=s(376),a=Array;e.World=class World{constructor(){this.storage=[],this.entityBitMasks=[],this.entityPool=(0,i.newEntityPoolWithStaticComponentsReserved)(),this.systems=[],this.clock=new r.Clock((()=>this.run()))}startRunning(){this.clock.startRunning()}systemFor(t,e){return Object.assign(new o.System(t),e)}create(t){const e=this.entityPool.alloc();return t&&this.set(e,t),e}debugInfoFor(t){const e={};return this.storage.forEach(((s,o)=>{var r,n;const a=null==s?void 0:s[t];if(!a)return;const c=null!==(n=null===(r=(0,i.getComponentClassById)(o))||void 0===r?void 0:r.name)&&void 0!==n?n:`${o}`;e[c]=a})),e}destroy(t){var e;this.systems.forEach((e=>e.removeEntityIfPresent(t))),null===(e=this.entityBitMasks[t])||void 0===e||e.clear(),this.storage.forEach((e=>e?e[t]=void 0:void 0)),this.entityPool.free(t)}get(t,e){var s;return null===(s=this.storage[e.componentId])||void 0===s?void 0:s[t]}set(t,e){var s,i,o,r;const c=null!==(s=(o=this.entityBitMasks)[t])&&void 0!==s?s:o[t]=new n.BitMask(62);for(const s of e){const{componentId:e}=s.constructor;c.set(e,!0);(null!==(i=(r=this.storage)[e])&&void 0!==i?i:r[e]=new a)[t]=s}this.updateSystemsForEntity(t,c)}remove(t,e){const s=this.entityBitMasks[t];if(s){for(const i of e){const{componentId:e}=i;s.set(e,!1);const o=this.storage[e];o&&(o[t]=void 0)}this.updateSystemsForEntity(t,s)}}addSystem(t){this.systems.push(t),t.componentTypes.forEach((({componentId:e})=>{t._requiredBits.set(e,!0)})),this.entityBitMasks.forEach(((e,s)=>{this.updateSystemForEntity(t,s,e)}))}addSystems(t=[]){for(const e of t)this.addSystem(e)}run(){for(const t of this.systems)t.run(t._entities)}updateSystemsForEntity(t,e){for(const s of this.systems)this.updateSystemForEntity(s,t,e)}updateSystemForEntity(t,e,s){s.isSuperSetOf(t._requiredBits)?t.setEntityComponents(e,t.componentTypes.map((t=>this.get(e,t)))):t.removeEntityIfPresent(e)}}},956:function(t,e,s){var i=this&&this.__createBinding||(Object.create?function(t,e,s,i){void 0===i&&(i=s);var o=Object.getOwnPropertyDescriptor(e,s);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[s]}}),Object.defineProperty(t,i,o)}:function(t,e,s,i){void 0===i&&(i=s),t[i]=e[s]}),o=this&&this.__exportStar||function(t,e){for(var s in t)"default"===s||Object.prototype.hasOwnProperty.call(e,s)||i(e,t,s)};Object.defineProperty(e,"__esModule",{value:!0}),o(s(480),e),o(s(764),e),o(s(816),e),o(s(185),e),o(s(676),e),o(s(100),e),o(s(704),e),o(s(248),e),o(s(351),e),o(s(528),e),o(s(872),e),o(s(116),e),o(s(260),e),o(s(605),e),o(s(748),e),o(s(724),e),o(s(776),e)},184:(t,e,s)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.ArrangementPlaySystem=e.ArrangementPlay=void 0;const o=s(972),r=s(956),n=s(264),a=s(92);class ArrangementPlay{constructor(t){this.config=t,this.startTimestamp=0,this.voices={},this.pendingNotes={},this.scheduledSections=0,this.scheduleFinishTime=0}setupVoicesIfNeeded(t){var e,s,i,r;for(const[n,a]of Object.entries(this.config.voices))null!==(e=(i=this.voices)[n])&&void 0!==e||(i[n]=new o.Voice(t,a)),null!==(s=(r=this.pendingNotes)[n])&&void 0!==s||(r[n]=[])}scheduleSectionsIfNeeded(t){var e;if(t<=this.scheduleFinishTime)return;const{pre:s,loop:i}=this.config,o=null!==(e=null==s?void 0:s.length)&&void 0!==e?e:0;if(s&&this.scheduledSections<o)this.scheduleSection(s[this.scheduledSections],this.scheduleFinishTime),this.scheduledSections++;else if(i){let t=this.scheduledSections-o;for(;t>=i.length;)t-=i.length;this.scheduleSection(i[t],this.scheduleFinishTime),this.scheduledSections++}}scheduleSection(t,e=0){const s=this.config.sections[t];if(!s)throw new Error(`No section named ${t}`);let i=0;for(const[t,o]of Object.entries(s)){if(!this.voices[t])throw new Error(`No voice named ${t}`);let s=e;for(const e of o)(0,a.riffSeqToVoiceNotes)(e).forEach((([e,i])=>{this.pendingNotes[t].push([e+s,i])})),s+=(0,a.riffDuration)(e);s>i&&(i=s)}this.scheduleFinishTime=i}continuePlaying(t,e){const s=e.timestamp/1e3;0===this.startTimestamp&&(this.startTimestamp=s,this.scheduleFinishTime=this.startTimestamp);const i=s+2/e.currentFramesPerSecond;this.scheduleSectionsIfNeeded(i);for(const[t,e]of Object.entries(this.voices)){const s=this.pendingNotes[t];for(;s.length>0;){const[t,o]=s[0];if(t>i)break;s.shift(),e.scheduleNote(t,o)}}}}e.ArrangementPlay=ArrangementPlay,i=ArrangementPlay,ArrangementPlay.componentId=(0,r.registerComponent)(i);e.ArrangementPlaySystem=t=>t.systemFor([n.Context,ArrangementPlay],{runEach(e,s,i){s.audio.resume(),i.continuePlaying(s,t.clock)},runEachSet(t,e,s){s.setupVoicesIfNeeded(e)}})},668:function(t,e,s){var i=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(o,r){function n(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(n,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.makeAudioWorkletNodeFactory=e.AudioWorkletProcessor=void 0;const o=s(264);class AudioWorkletProcessor{static get parameterDescriptors(){return[]}}e.AudioWorkletProcessor=AudioWorkletProcessor,AudioWorkletProcessor.workletOptions={},e.makeAudioWorkletNodeFactory=function(t){const e=`data:text/javascript,${encodeURIComponent(t.toString())}; registerProcessor('${t.name}', ${t.name})`;let s=new WeakMap;return o.Context.setupFns.push((t=>i(this,void 0,void 0,(function*(){let i=s.get(t);i||(i=t.audio.audioWorklet.addModule(e),s.set(t,i)),yield i})))),e=>new AudioWorkletNode(e,t.name,t.workletOptions)}},264:function(t,e,s){var i,o=this&&this.__awaiter||function(t,e,s,i){return new(s||(s=Promise))((function(o,r){function n(t){try{c(i.next(t))}catch(t){r(t)}}function a(t){try{c(i.throw(t))}catch(t){r(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(n,a)}c((i=i.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.Context=void 0;const r=s(956);class Context{static setup(){return o(this,void 0,void 0,(function*(){const t=new i;return yield Promise.all(i.setupFns.map((e=>e(t)))),t}))}constructor(){this.audio=new AudioContext({sampleRate:44100,latencyHint:"interactive"})}}e.Context=Context,i=Context,Context.componentId=(0,r.registerComponent)(i),Context.setupFns=[]},492:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.NESNoise=e.NESNoiseProcessor=void 0;const i=s(668);class AudioWorkletProcessor extends i.AudioWorkletProcessor{}class NESNoiseProcessor extends AudioWorkletProcessor{constructor(){super(...arguments),this.travel=0,this.shiftRegister=1,this.inverseSampleRate=.00026360638479979066}static get parameterDescriptors(){return[{name:"freq",defaultValue:440,minValue:0,maxValue:2e4,automationRate:"a-rate"},{name:"gain",defaultValue:0,minValue:0,maxValue:1,automationRate:"a-rate"},{name:"timbre",defaultValue:4,minValue:0,maxValue:4,automationRate:"a-rate"}]}process(t,e,s){var i,o,r;const n=e[0][0];for(let t=0;t<n.length;t++){const e=null!==(i=s.freq[t])&&void 0!==i?i:s.freq[0],a=null!==(o=s.gain[t])&&void 0!==o?o:s.gain[0],c=null!==(r=s.timbre[t])&&void 0!==r?r:s.timbre[0],u=Math.floor(c)+1;for(this.travel+=this.inverseSampleRate*e;this.travel>1;){this.travel-=1;const t=(1&this.shiftRegister)>0!==(this.shiftRegister>>u&1)>0;this.shiftRegister=this.shiftRegister>>1|(t?0:1)<<14}const l=2*(1&this.shiftRegister)-1;n[t]=l*a}return!0}}e.NESNoiseProcessor=NESNoiseProcessor,NESNoiseProcessor.nodeOptions={numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[1]},e.NESNoise=(0,i.makeAudioWorkletNodeFactory)(NESNoiseProcessor)},844:function(t,e,s){var i=this&&this.__createBinding||(Object.create?function(t,e,s,i){void 0===i&&(i=s);var o=Object.getOwnPropertyDescriptor(e,s);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[s]}}),Object.defineProperty(t,i,o)}:function(t,e,s,i){void 0===i&&(i=s),t[i]=e[s]}),o=this&&this.__exportStar||function(t,e){for(var s in t)"default"===s||Object.prototype.hasOwnProperty.call(e,s)||i(e,t,s)};Object.defineProperty(e,"__esModule",{value:!0}),o(s(184),e),o(s(668),e),o(s(264),e),o(s(92),e),o(s(972),e),o(s(492),e)},228:(t,e,s)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.OscAudioWorkletNodeFactory=e.OscAudioWorkletProcessor=void 0;const i=s(668);class AudioWorkletProcessor extends i.AudioWorkletProcessor{}class OscAudioWorkletProcessor extends AudioWorkletProcessor{constructor(){super(...arguments),this.travel=0,this.priorGain=0,this.priorTimbre=0,this.vibratoTravel=0,this.priorVibratoAmount=0}static get parameterDescriptors(){return[{name:"freq",defaultValue:440,minValue:0,maxValue:2e4,automationRate:"a-rate"},{name:"gain",defaultValue:0,minValue:0,maxValue:1,automationRate:"a-rate"},{name:"timbre",defaultValue:4,minValue:0,maxValue:4,automationRate:"a-rate"},{name:"vibrato",defaultValue:0,minValue:-120,maxValue:120,automationRate:"a-rate"},{name:"vibratoFreq",defaultValue:5,minValue:0,maxValue:200,automationRate:"a-rate"}]}process(t,e,s){var i,o,r,n,a;const c=e[0][0],u=1/44100,l=OscAudioWorkletProcessor;for(let t=0;t<c.length;t++){let e=null!==(i=s.freq[t])&&void 0!==i?i:s.freq[0],d=null!==(o=s.gain[t])&&void 0!==o?o:this.priorGain,h=null!==(r=s.timbre[t])&&void 0!==r?r:this.priorTimbre,f=null!==(n=s.vibrato[t])&&void 0!==n?n:this.priorVibratoAmount;const m=null!==(a=s.vibratoFreq[t])&&void 0!==a?a:s.vibratoFreq[0];if(0===this.priorGain&&(this.travel=1,this.vibratoTravel=1),this.vibratoTravel+=u*m,this.vibratoTravel<=1)f=this.priorVibratoAmount;else for(;this.vibratoTravel>1;)this.vibratoTravel-=1;const{vibratoTravel:v}=this,p=1;if(e*=l.semitonesToRatio(f*l.waveform(v,p)),this.travel+=u*e,this.travel<=1)d=this.priorGain,h=this.priorTimbre;else for(;this.travel>1;)this.travel-=1;const{travel:y}=this;c[t]=l.waveform(y,h)*d,this.priorGain=d,this.priorTimbre=h,this.priorVibratoAmount=f}return!0}static semitonesToRatio(t){return Math.pow(2,t/12)}static waveform(t,e){if(0===e)return Math.sin(2*t*Math.PI);if(1===e)return t<=.25?4*t:t<=.75?2-4*t:4*t-4;if(2===e)return 1-2*t;if(e<1){return(1-e)*Math.sin(2*t*Math.PI)+e*(t<=.25?4*t:t<=.75?2-4*t:4*t-4)}if(e<2){const s=-.25*e+.5,i=1/s;return t<=s?t*i:t<1-s?1-(t-s)*(2/(1-2*s)):(t-1)*i}if(e<3){return(3-e)*(1-2*t)+(e-2)*(t<=.5?1:-1)}if(e<=4){return t<=.5*Math.pow(.25,e-3)?1:-1}return 0}}e.OscAudioWorkletProcessor=OscAudioWorkletProcessor,OscAudioWorkletProcessor.nodeOptions={numberOfInputs:0,numberOfOutputs:1,outputChannelCount:[1]},e.OscAudioWorkletNodeFactory=(0,i.makeAudioWorkletNodeFactory)(OscAudioWorkletProcessor)},92:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.riffSeqToVoiceNotes=e.riffCharCodeToGain=e.riffOctaveAt=e.riffGainAt=e.riffCharCodeToOctave=e.riffScaleNumberToFrequency=e.riffKeyToSemitoneOffset=e.riffScaleNumberToSemitoneOffset=e.riffCharCodeToScaleNumber=e.riffDuration=e.riffComputeStepSizes=void 0;const s="o".charCodeAt(0),i="0".charCodeAt(0),o="p".charCodeAt(0),r="1".charCodeAt(0),n="q".charCodeAt(0),a="2".charCodeAt(0),c="w".charCodeAt(0),u="3".charCodeAt(0),l="e".charCodeAt(0),d="4".charCodeAt(0),h="r".charCodeAt(0),f="5".charCodeAt(0),m="t".charCodeAt(0),v="6".charCodeAt(0),p="y".charCodeAt(0),y="7".charCodeAt(0),b="u".charCodeAt(0),g="8".charCodeAt(0),w="i".charCodeAt(0),A="9".charCodeAt(0),x="-".charCodeAt(0),k=" ".charCodeAt(0),S="0".charCodeAt(0),C="9".charCodeAt(0),P="@".charCodeAt(0),q=" ".charCodeAt(0),O="+".charCodeAt(0),E="-".charCodeAt(0),_=",".charCodeAt(0),M="`".charCodeAt(0),B="^".charCodeAt(0),T="-".charCodeAt(0),V=" ".charCodeAt(0),N="0".charCodeAt(0),R="9".charCodeAt(0),F="@".charCodeAt(0);function j(t){const e=[],s=t.split(""),i=s.length;s.push("|");for(let t=-1;t<i;){const i=s.indexOf("|",t+1);if(t>=0){const s=i-t;e.push(...Array(s).fill(1/s))}t=i}return e}function I(t){switch(t){case s:return-.5;case i:return 0;case o:return.5;case r:return 1;case n:return 1.5;case a:return 2;case c:return 2.5;case u:return 3;case l:return 3.5;case d:return 4;case h:return 4.5;case f:return 5;case m:return 5.5;case v:return 6;case p:return 6.5;case y:return 7;case b:return 7.5;case g:return 8;case w:return 8.5;case A:return 9}throw new Error(`Unknown riff scale code: ${t}`)}function W(t,e){let s=0;for(;t<1;)t+=7,s-=12;for(;t>=8;)t-=7,s+=12;switch(t){case 1:return s+0;case 1.5:return s+1;case 2:return s+2;case 2.5:return s+3;case 3:return s+(e.endsWith("-minor")?3:4);case 3.5:return s+4;case 4:return s+5;case 4.5:return s+6;case 5:return s+7;case 5.5:return s+8;case 6:return s+(e.endsWith("-minor")?8:9);case 6.5:return s+(e.endsWith("-minor")?9:10);case 7:return s+(e.endsWith("-minor")?10:11);case 7.5:return s+11}throw new Error(`Unknown riff scale number: ${t}`)}function L(t){switch(t.split("-")[0]){case"C":return-9;case"C#":case"Db":return-8;case"D":return-7;case"D#":case"Eb":return-6;case"E":return-5;case"F":return-4;case"F#":case"Gb":return-3;case"G":return-2;case"G#":case"Ab":return-1;case"A":return 0;case"A#":case"Bb":return 1;case"B":return 2}throw new Error(`Unknown riff key: ${t}`)}function U(t,e,s){const i=L(s)+W(t,s);return 440*Math.pow(2,e-4+i/12)}function D(t,e){if(t>=S&&t<=C)return t-S;if(t===P)return 10;if(t===q)return e;if(t===O)return e+1;if(t===E)return e-1;if(isNaN(t))return e;throw new Error(`Unknown riff octave code: ${t}`)}function K(t,e){var s;let i=1;if(!t.vol)return i;for(let o=0;o<=e;o++)i=null!==(s=$(t.vol.charCodeAt(o)))&&void 0!==s?s:i;return i}function G(t,e){let s=4;if(!t.oct)return s;for(let i=0;i<=e;i++)s=D(t.oct.charCodeAt(i),s);return s}function $(t){if(t>=N&&t<=R)return(t-N)/10;if(t===F)return 1;if(t!==V&&!isNaN(t))throw new Error(`Unknown riff volume code: ${t}`)}function z(t,e,s,i){var o;let r=0,n=s;for(;n<e.length&&i(e.charCodeAt(n),n);n++)r+=null!==(o=t[n])&&void 0!==o?o:0;return{duration:r,stepCount:n-s}}function Z(t,e,s,i,o){var r,n;if(!t.gls)return;const a=60/t.bpm,c=z(e,t.gls,s,(t=>t===o)),u=I(t.gls.charCodeAt(s+c.stepCount))*(o===_?-1:1),l=i.duration-(null!==(r=e[s])&&void 0!==r?r:0)*a,d=l+c.duration*a,h=U(i.scaleNumber+u,G(t,s),t.key)-i.freqBase;i.freqSlides=null!==(n=i.freqSlides)&&void 0!==n?n:[],i.freqSlides.push({timeStart:l,timeEnd:d,deltaStart:h,deltaEnd:0})}function X(t,e,s,i){var o,r,n,a;if(!t.gls)return;const c=60/t.bpm,u=(null!==(o=e[s])&&void 0!==o?o:0)*c,l=z(e,t.gls,s,((t,e)=>e===s||t===T)),d=l.duration*c,h=l.stepCount,f=function(t,e,s){for(let i=e;i<s;i++){const e=t.seq.charCodeAt(i);if(e!==x&&e!==k)return{scaleNumber:I(e),octave:G(t,i)}}}(t,s,s+h);if(!f)return;i.freqSlides=null!==(r=i.freqSlides)&&void 0!==r?r:[];const m=i.duration-u,v=m+d,p=null!==(a=null===(n=i.freqSlides[i.freqSlides.length-1])||void 0===n?void 0:n.deltaEnd)&&void 0!==a?a:0,y=U(f.scaleNumber,f.octave,t.key)-i.freqBase;i.freqSlides.push({timeStart:m,timeEnd:v,deltaStart:p,deltaEnd:y})}e.riffComputeStepSizes=j,e.riffDuration=function(t){var e;const s=60/t.bpm,i=j(t.div);let o=0;for(let r=0;r<t.seq.length;r++)o+=(null!==(e=i[r])&&void 0!==e?e:0)*s;return o},e.riffCharCodeToScaleNumber=I,e.riffScaleNumberToSemitoneOffset=W,e.riffKeyToSemitoneOffset=L,e.riffScaleNumberToFrequency=U,e.riffCharCodeToOctave=D,e.riffGainAt=K,e.riffOctaveAt=G,e.riffCharCodeToGain=$,e.riffSeqToVoiceNotes=function(t){var e,s,i,o,r,n;const a=60/t.bpm,c=j(t.div),u=[];let l,d=0;for(let h=0;h<t.seq.length;h++){const f=(null!==(e=c[h])&&void 0!==e?e:0)*a,m=t.seq.charCodeAt(h),v=null===(s=t.gls)||void 0===s?void 0:s.charCodeAt(h),p=null===(i=t.vol)||void 0===i?void 0:i.charCodeAt(h);if(m===x)l&&(l.duration+=f);else if(m===k);else if(!l||v!==B&&v!==T){const e=I(m),s=G(t,h);l={duration:f,freqBase:U(e,s,t.key),scaleNumber:e,octave:s},u.push([d,l]);const i=K(t,h);1!=i&&void 0===$(null!=p?p:0)&&(null!==(o=l.gainEvents)&&void 0!==o||(l.gainEvents=[]),l.gainEvents.push({time:0,gain:i}))}else l&&(l.duration+=f);if(l&&v){const e=null===(r=t.gls)||void 0===r?void 0:r.charCodeAt(h-1);v===B&&e!==B?X(t,c,h,l):v===_&&e!==_?Z(t,c,h,l,_):v===M&&e!==M&&Z(t,c,h,l,M)}if(l&&p){const t=$(p);void 0!==t&&(null!==(n=l.gainEvents)&&void 0!==n||(l.gainEvents=[]),l.gainEvents.push({time:l.duration-f,gain:t}))}d+=f}return u.forEach((([t,e])=>{delete e.scaleNumber,delete e.octave})),u}},972:(t,e,s)=>{var i;Object.defineProperty(e,"__esModule",{value:!0}),e.Voice=void 0;const o=s(956),r=s(228);function n(t){return t.createGain().gain}class Voice{constructor(t,e){var s,i,o,a,c,u,l,d,h;this.context=t,this.config=e;const f=(null!==(s=this.config.worklet)&&void 0!==s?s:r.OscAudioWorkletNodeFactory)(t.audio),m=t.audio.createGain(),v=t.audio.createStereoPanner();f.connect(m),m.connect(v),v.connect(t.audio.destination),this.freq=null!==(i=f.parameters.get("freq"))&&void 0!==i?i:n(t.audio),this.gain=null!==(o=f.parameters.get("gain"))&&void 0!==o?o:n(t.audio),this.timbre=null!==(a=f.parameters.get("timbre"))&&void 0!==a?a:n(t.audio),this.vibrato=null!==(c=f.parameters.get("vibrato"))&&void 0!==c?c:n(t.audio),this.vibratoFreq=null!==(u=f.parameters.get("vibratoFreq"))&&void 0!==u?u:n(t.audio),this.finalGain=m.gain,this.finalPan=v.pan,this.freq.value=440,this.gain.value=0,this.timbre.value=null!==(l=this.config.timbre)&&void 0!==l?l:0,this.vibrato.value=null!==(d=this.config.vibrato)&&void 0!==d?d:0,this.vibratoFreq.value=null!==(h=this.config.vibratoFreq)&&void 0!==h?h:4,this.finalGain.value=this.config.gain,this.finalPan.value=this.config.pan}scheduleNote(t,e){const s=t,i=s+e.duration,{gain:o,freq:r}=this;r.setValueAtTime(e.freqBase,s),e.freqSlides&&e.freqSlides.forEach((t=>{r.setValueAtTime(e.freqBase+t.deltaStart,s+t.timeStart),r.exponentialRampToValueAtTime(e.freqBase+t.deltaEnd,s+t.timeEnd)})),o.cancelScheduledValues(s),o.setValueAtTime(0,s),o.linearRampToValueAtTime(1,s+0),e.gainEvents&&e.gainEvents.forEach((({time:t,gain:e})=>{o.setValueAtTime(e,s+t)})),o.cancelScheduledValues(i-.01),o.setValueAtTime(0,i-.01),o.linearRampToValueAtTime(0,i)}}e.Voice=Voice,i=Voice,Voice.componentId=(0,o.registerComponent)(i)},608:function(t,e,s){var i=this&&this.__createBinding||(Object.create?function(t,e,s,i){void 0===i&&(i=s);var o=Object.getOwnPropertyDescriptor(e,s);o&&!("get"in o?!e.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return e[s]}}),Object.defineProperty(t,i,o)}:function(t,e,s,i){void 0===i&&(i=s),t[i]=e[s]}),o=this&&this.__exportStar||function(t,e){for(var s in t)"default"===s||Object.prototype.hasOwnProperty.call(e,s)||i(e,t,s)};Object.defineProperty(e,"__esModule",{value:!0}),e.Onyx=void 0,e.Onyx=s(844),o(s(844),e)}},e={};function s(i){var o=e[i];if(void 0!==o)return o.exports;var r=e[i]={exports:{}};return t[i].call(r.exports,r,r.exports,s),r.exports}s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var t=s(956),e=s(608);const i=173,o="Bb-minor",r={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   ",seq:"5-555-553-5-  4-  7-7-7-7-7-5-5-",gls:",,1               ,,p   ,,p ",vol:"@ 86@ 86  8       @ 8 8 @ 8 9 6",oct:"4                 -"},n={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   ",seq:"8-531-815-3-  2- ",gls:",,1              ",vol:"2 424 646 8      ",oct:"4       5        "},a={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   ",seq:"5 1-- 551-- 5 1----- ",gls:"  ,,,8  ,,,8  ,,,,,,8",oct:"7 6   766   6 7   ",vol:"6 @   68@   4 987631"},c={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   ",seq:"1---  1---  1-2---",gls:"`9    `9    `9,1  ",vol:"@@6@  @@6@  @6@@6@",oct:"1"},u={bpm:i,key:o,div:"||||||       |   ||",seq:"         0-247---",vol:"         3 59@631",oct:"9"},l={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   ",seq:"5 5 1-5 5 5 1-5 5 5 1-5 5 5 1-5 ",gls:"    ,,8     ,,8     ,,8     ,,8 ",oct:"7   6 7 7   6 7 7   6 7 7   6 7 ",vol:"6   @ 6 6   @ 6 6   @ 6 6   @ 6 "},d={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"1-1-1-1-  1-3-5-0-0 0-0 4-4-1-1-6-6-6-6-  6-1-3-0-0-0-0-  0-4-7-",vol:"@6@6@6@6  @6@   @6@ @6@ @6@6@6@6@6@6@6@6  @6@   @6@6@6@6  @6@   ",gls:"`9    `9    `7  `9      `9  `9  `9    `9    `7  `9    `9    `6  ",oct:"1                       0       0         0 1   1         1     "},h={bpm:i,key:o,div:"| | | | | | | | | | | | | | | | ",seq:"51035451045337206313487479742904",oct:"24423234244142442442424424424244",vol:"456"},f={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"8-531-815-3-  2-  815-3-  2-  0-8-631-816-3-  2-  7-  4-  7-    ",gls:",,1                                                             ",vol:"4 626 846 8       646 8   6   2 4 624 646 8       6             ",oct:"4       5         4 5           4       5         4             "},m={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"5-------- 1-3-7-  6-  5---3-4-5------ 8------ 9------ 4------",vol:"@49382716 @4@4@4  @4  @493@4@4@493827 @493827 @493827 @493827",gls:",q"},v={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"  9---8-5---7-8-3-2---3---2-3-5-----------4-2-7-----------9-7-4-",vol:"  @49382@493@49382@493@4938271@493827161417182@4938271614193@4@4",gls:"  ,,1                                                     ,1    ",oct:"4               5                                           4   "},p={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"5-------- 1-3-7-  6-  5---3-4-5------ 8------ 9---4-7-9-7------",vol:"@49382716 @4@4@4  @4  @493@4@4@493827 @493827 @493827   @493827",gls:",q                                                      ,q",oct:"4                                                       5"},y={bpm:i,key:o,div:"|       |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"    7-7-3-7-5------                                           3-3-3-",vol:"    @4@48   @493827                                           7193@4",gls:"    ,p      ,,1                                               ,1    ",oct:"4           5                                                       "},b={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   ",seq:"1-5---1-5---1-5---5 5 5 5 5 5 5 ",gls:",,5   ,,5   ,,5                 ",oct:"6     6     6     7   7   7   7 ",vol:"@86421@86421@864214 5 6 7 8 9 @ "},g={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"6---6-6-  5-6---  1-6-5-  4-  3-1---1-1-  0-1---",vol:"@686@6@6  @6@     @6@ @6  @6    @686@6@6  @6@   ",gls:"`9    `9    `9      `3    `1    `9    `9    `9",oct:"0                 1             1"},w={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"4---4-4-  3-4---  1-7-4-  3-  8-7---7-7-  6-7---",vol:"@ 8 @6@6  @6@     @6@ @6  @6    @ 8 @6@6  @6@   ",gls:"`9    `9    `9      `2    `2    `9    `9    `9",oct:"0                 1             0"},A={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"4---4-4-  3-4---  6-------5-4-3-5---5-5-  4-5---",vol:"@ 8 @6@6  @6@     @8      @8@8@8@ 8 @6@6  @6@   ",gls:"`9    `9    `9    `3  `3  `4    `9    `9    `9",oct:"0                 1             0"},x={bpm:i,key:o,div:"| | | | | | | | | | | | | | | | ",seq:"61313638034373715013038597355193",oct:"24424424254144242442442424424424",vol:"6"},k={bpm:i,key:o,div:"| | | | | | | | | | | | | | | | ",seq:"61414863442664714012028497244092",oct:"24424425255144242442442424424424",vol:"6"},S={bpm:i,key:o,div:"| | | | | | | | | | | | | | | | ",seq:"61414863442664715p1p254u295u425p",oct:"24424425255144242442443434424424",vol:"6"},C={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"3---3---3-5---4---2---    1-4-5-------    1-4-7-----  9-------- ",gls:",,1       `p      `p      ,,1             ,,1                   ",vol:"@ 93@ 93@4@ 93@ 93@ 93    @ @4@ 93        @ @4@ 93    @ 93      ",oct:"5"},P={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"      3-- 2-- 3-- 4-5-0-----      1-4-5-----  7---6---5---4---3-",gls:"                  ,,2                         ,,2               ",vol:"      31  31  31  3   3 21        5   5 41    5 415 415 415 41  "},q={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"  3---2-5---          6---5-3-7-------                    3-3-3-",vol:"  @ 93@4@ 93          @ 93@4@4@ 92                        7193@4",gls:"  ,,q                 ,,q                                 ,1    ",oct:"  6     5                                                       "},O={bpm:i,key:o,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"          3---2-5-------          3-4-6---5-3-1-5-----4-------- ",gls:"          ,,q                                                   ",vol:"          5 41545 41              3 4 5 415 4 3 5 41  5 41      ",oct:"          5     4"},E={voices:{leadL:{timbre:2.75,gain:.08,pan:-.7},leadR:{timbre:2.75,gain:.08,pan:.7},leadC:{timbre:3,gain:.1,pan:0},bass:{timbre:1.1,gain:.5,pan:0},drums:{timbre:0,gain:.08,pan:0,worklet:e.Onyx.NESNoise},noise:{timbre:5,gain:.1,pan:0,worklet:e.Onyx.NESNoise}},sections:{intro:{leadL:[r],leadR:[n],bass:[c],drums:[a],noise:[u]},main1:{leadC:[m],leadL:[h],leadR:[f],bass:[d],drums:[l,l]},main2:{leadC:[v],leadL:[h],leadR:[f],bass:[d],drums:[l,l]},main3:{leadC:[p],leadL:[h],leadR:[f],bass:[d],drums:[l,l]},main4:{leadC:[y],leadL:[h],leadR:[f],bass:[d],drums:[l,l]},mid1:{leadC:[C],leadL:[x],leadR:[P],bass:[g],drums:[b,b]},mid2:{leadC:[q],leadL:[k],leadR:[O],bass:[w],drums:[b,b]},mid4:{leadL:[S],bass:[A],drums:[b,b]}},pre:["intro"],loop:["main1","main2","main3","main4","mid1","mid2","mid1","mid4"]},_=181,M="C-minor",B={bpm:_,key:M,div:"|   |   |   |   |   |   |   |   ",seq:"5 5 1-5 5 5 1-5 5 5 1-5 5 5 1-5 ",gls:"    ,,8     ,,8     ,,8     ,,8 ",oct:"7   6 7 7   6 7 7   6 7 7   6 7 ",vol:"6   @ 6 6   @ 6 6   @ 6 6   @ 6 "},T={bpm:_,key:M,div:"| | | | | | | | ",seq:"3533513553335335",oct:"2442444244244244"},V={bpm:_,key:M,div:"| | | | | | | | ",seq:"2422402542224224",oct:"2442444244244244"},N={bpm:_,key:M,div:"|   |   |   |   |   |   |   |   ",seq:" 3-5-3-3-5-1-3-5-5-3-3-3-5-3-3-5",oct:" 2 4 4 2 4 4 4 2 4 4 2 4 4 2 4 4",vol:"8"},R={bpm:_,key:M,div:"|   |   |   |   |   |   |   |   ",seq:" 2-4-2-2-4-0-2-5-4-2-2-2-4-2-2-4",oct:" 2 4 4 2 4 4 4 2 4 4 2 4 4 2 4 4",vol:"8"},F={bpm:_,key:M,div:"|   |   |   |   |   |   |   |   ",seq:"1---3-1-  0-3-1-1---3-1-  0-3-1-",gls:"    ``5     ``5     ``5     ``5 "},j={bpm:_,key:M,div:"|   |   |   |   |   |   |   |   ",seq:"2---3-2-  1-3-2-2---3-2-  1-3-2-",gls:"    ``5     ``5     ``5     ``5 "},I={bpm:_,key:M,div:"|   |   |   |   |   |   |   |   ",seq:"2---3-2-  1-3-2-p---3-2-  p-3-2-",gls:"    ``5     ``5     ``5     ``5 "},W={bpm:_,key:M,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"3-----  3-4-  5-  4-  3-  3-4-- 2-3-2 2-  1-- 0-----  7---- 6---",oct:"5"},L={bpm:_,key:M,div:"|   |   |   |   |   |   |   |   |   |   |   |   |   |   |   |   ",seq:"5-----  5-4-3-7-  6-  5-  5-8-u-------    5-u-9-------          ",oct:"5"},U={voices:{leadL:{timbre:3,gain:.06,pan:-.33},leadR:{timbre:3,gain:.06,pan:.33},leadC:{timbre:3,gain:.1,pan:0,vibrato:-.5,vibratoFreq:8},bass:{timbre:1,gain:.5,pan:0},noise:{timbre:0,gain:.08,pan:0,worklet:e.Onyx.NESNoise}},sections:{walk:{leadL:[F,j,F,I],leadR:[N,R,N,R],bass:[T,V,T,V],noise:[B,B,B,B]},walkWithMelody:{leadC:[W,L],leadL:[F,j,F,I],leadR:[N,R,N,R],bass:[T,V,T,V],noise:[B,B,B,B]}},loop:["walk","walkWithMelody"]},D=241,K="D-minor",G={bpm:D,key:K,div:"| | | | | | | | | | | | | | | | ",seq:"0135----5431----4310----1-------",gls:",p      `p       ",vol:"@89@ 2  @89@ 2  @89@ 2  @ 282622",oct:"5"},$={bpm:D,key:K,div:"| | | | | | | | | | | | | | | | ",seq:"0135----5431----4310----7-------",gls:",p      `p              ,,q",vol:"@89@ 2  @89@ 2  @89@ 2  @ 282622",oct:"5"},z={bpm:D,key:K,div:"| | | | | | | | | | | | | | | | ",seq:"7540----4435----3479 8-7--------",gls:",p      ,p              ",vol:"@89@ 2  @89@ 2  @89@   @ 282622",oct:"5"},Z={bpm:D,key:K,div:"|   |   |   |   |   |   |   |   ",seq:"1-- 0-1-3-- 1-3-5-7-5-  4-  3-  ",gls:",,1             ,,1",vol:"",oct:"4"},X={bpm:D,key:K,div:"|   |   |   |   |   |   |   |   ",seq:"5-- 4-5-8-- 5-1-3-5-3-  2-  1-  ",gls:",,1             ,,1",vol:"",oct:"4             5"},H={bpm:D,key:K,div:"|   |   |   |   |   |   |   |   ",seq:"1---  1---  1-----------        ",gls:"`9    `9    ````````````8       ",vol:"@@6@  @@6@  @6@@6@              ",oct:"2"},Y={bpm:D,key:K,div:"|   |   |   |   |   |   |   |   ",seq:"5 2 2 5 2 2 1---5 2 2 5 2 1-1---",gls:"            ,,8           ,8,,8 ",oct:"7     7     6   7     7   6 6   ",vol:"6 3 3 6 3 3 @7536 3 3 6 3 @7@753"},J={voices:{leadL:{timbre:3.75,gain:.05,pan:-.33},leadR:{timbre:3.75,gain:.05,pan:.33},leadC:{timbre:2.5,gain:.1,pan:0,vibrato:-.5,vibratoFreq:6},bass:{timbre:1,gain:.5,pan:0},noise:{timbre:0,gain:.08,pan:0,worklet:e.Onyx.NESNoise}},sections:{main1:{leadL:[Z,Z],leadR:[X,X],leadC:[G],bass:[H,H],noise:[Y,Y]},main3:{leadL:[Z,Z],leadR:[X,X],leadC:[$],bass:[H,H],noise:[Y,Y]},main4:{leadC:[z],bass:[H,H],noise:[Y,Y]}},loop:["main1","main1","main3","main4"]},Q=new t.World;Q.addSystems([e.Onyx.ArrangementPlaySystem(Q)]);const tt=t=>{Q.clock.tick(t),requestAnimationFrame(tt)};requestAnimationFrame(tt);const et=Q.create(),st=t=>{const s=new e.Onyx.ArrangementPlay(t);s.setupVoicesIfNeeded(it),Q.set(et,[it,s])};let it;e.Onyx.Context.setup().then((t=>{it=t;const s=()=>{switch(console.log(window.location.hash),window.location.hash){case"#silence":Q.remove(et,[e.Onyx.ArrangementPlay]);break;case"#blossoming-blade":st(E);break;case"#bubble-man":st(U);break;case"#stage-select-screen":st(J)}};window.addEventListener("hashchange",s),s()}))})()})();